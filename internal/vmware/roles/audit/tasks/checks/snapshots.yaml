---
# internal.vmware.audit : tasks/checks/snapshots.yaml

- name: Snapshots | Generate Alerts from discovery inventory
  ansible.builtin.set_fact:
    vmware_alerts: >-
      {{
        (vmware_alerts | default([]) | list)
        + (
          vmware_ctx
          | internal.vmware.audit_snapshot_alerts(
            vmware_snapshot_age_warning_days | default(7) | int,
            vmware_snapshot_size_warning_gb | default(100) | float,
            vmware_snapshot_items_max | default(25) | int
          )
        )
      }}
  changed_when: false
