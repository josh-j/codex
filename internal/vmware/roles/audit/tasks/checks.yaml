---
# internal.vmware.audit : checks.yaml

- name: Checks | Host Health & Infrastructure
  ansible.builtin.include_tasks: checks/health.yaml
  tags: ["checks", "infrastructure"]

- name: Checks | Host Configuration
  ansible.builtin.include_tasks: checks/configuration.yaml
  tags: ["checks", "configuration"]
  when: vmware_emit_per_cluster_alerts | default(true) | bool

# Optional: add a rollup-only configuration check if you implement it
# - name: Checks | Cluster Configuration Rollups
#   ansible.builtin.include_tasks: checks/configuration_rollup.yaml
#   tags: ['checks', 'configuration']
#   when: not (vmware_emit_per_cluster_alerts | default(true) | bool)

- name: Checks | Datastore Usage (Rollup)
  ansible.builtin.include_tasks: checks/storage_alerts.yaml
  tags: ["checks", "storage"]
  when: not (vmware_emit_per_object_storage_alerts | default(false) | bool)

- name: Checks | Datastore Usage (Per-Object)
  ansible.builtin.include_tasks: checks/storage.yaml
  tags: ["checks", "storage"]
  when: vmware_emit_per_object_storage_alerts | default(false) | bool

- name: Checks | VM Resources
  ansible.builtin.include_tasks: checks/resources.yaml
  tags: ["checks", "capacity"]

- name: Checks | VM Snapshots
  ansible.builtin.include_tasks: checks/snapshots.yaml
  tags: ["checks", "snapshots"]

- name: Checks | VM Tools
  ansible.builtin.include_tasks: checks/tools.yaml
  tags: ["checks", "workload"]

- name: Checks | vCenter Alarms
  ansible.builtin.include_tasks: checks/alarms.yaml
  tags: ["checks", "alarms"]
