---
# internal.vmware.stig : vm/collectors/vm_extra_config.yaml

- name: Extract VM extra config facts
  tags: [discovery, extra_config]
  ansible.builtin.set_fact:
    _vm_extra_config_facts: >-
      {% set vms = {} %}
      {% for vm in _vm_raw_payload | default([]) %}
        {% set _ = vms.update({
          vm.name: vm.advanced_settings | default({})
        }) %}
      {% endfor %}
      {{ vms }}
  when: _vm_raw_payload is defined
