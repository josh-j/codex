* { box-sizing: border-box; }
body { font-family: system-ui, "Segoe UI", Tahoma, sans-serif; font-size: 13px; margin: 0; background: #fff; color: #111; }
a { color: #00c; }
table { border-collapse: collapse; width: 100%; font-size: 13px; margin-bottom: 0; }
th { background: #f2f2f2; border: 1px solid #ccc; padding: 3px 8px; text-align: left; font-size: 11px; text-transform: uppercase; letter-spacing: 0.04em; color: #555; font-weight: bold; }
td { border: 1px solid #ddd; padding: 4px 8px; vertical-align: top; }
tr:nth-child(even) { background: #fafafa; }
.js tr.group-hdr:hover td, tr.row-interactive:hover td { background: #f0f4ff; }
.page-wrap { max-width: 1100px; margin: 0 auto; padding: 16px 20px; }
.page-header { background: #1e2a3a; color: #fff; padding: 10px 14px; margin-bottom: 0; display: flex; justify-content: space-between; align-items: flex-end; }
.page-header h1 { font-size: 15px; margin: 0; color: #fff; }
.page-header .right { text-align: right; font-size: 12px; color: #ccc; }
.page-header span { color: #fff; }
.sv-critical { color: #dc2626; font-weight: bold; }
.sv-warning  { color: #d97706; font-weight: bold; }
.sv-ok       { color: #166534; }
.sv-info     { color: #444; }
.alert-crit td { background: #fff5f5; }
.alert-warn td { background: #fffbeb; }
.toc { background: #f8f8f8; border: 1px solid #ddd; border-top: none; padding: 5px 12px; margin-bottom: 14px; font-size: 12px; border-radius: 0 0 3px 3px; display: flex; align-items: center; justify-content: space-between; }
.toc-left { display: flex; align-items: center; flex-wrap: wrap; gap: 8px 12px; }
.toc-right { display: flex; align-items: center; gap: 12px; }
.toc a { color: #00c; text-decoration: none; display: inline-flex; align-items: center; }
.toc-left a:not(:first-of-type)::before { content: "\b7"; margin-right: 12px; color: #999; font-weight: bold; flex-shrink: 0; }
.toc-left a { margin-right: 0; }
.toc a:hover { text-decoration: underline; }
.breadcrumb { font-size: 11px; color: #555; margin-bottom: 12px; display: flex; align-items: center; flex-wrap: wrap; background: #fcfcfc; padding: 4px 8px; border: 1px solid #eee; border-radius: 4px; }
.breadcrumb a { color: #0056b3; text-decoration: none; display: flex; align-items: center; font-weight: 500; }
.breadcrumb a:hover { color: #003d82; text-decoration: none; }
.breadcrumb .sep { margin: 0 8px; color: #ccc; font-size: 14px; font-weight: 300; }
.breadcrumb .site-home { margin-right: 6px; font-size: 16px; line-height: 1; margin-top: -2px; color: #666; }

/* Navigation Tree / Dropdown */
.nav-tree { position: relative; display: inline-flex; align-items: center; cursor: pointer; padding: 2px 8px; border-radius: 4px; background: #fff; border: 1px solid #ddd; margin-left: -4px; transition: all 0.15s ease; }
.nav-tree:hover { background: #f8f9fa; border-color: #0056b3; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
.nav-tree .tree-label { color: #333; font-weight: 600; font-size: 11px; }
.nav-tree .tree-trigger { margin-left: 6px; color: #0056b3; font-size: 9px; transition: transform 0.2s; }
.nav-tree:hover .tree-trigger { transform: translateY(1px); }

.nav-dropdown { 
    display: none; position: absolute; top: 100%; left: 0; 
    background: #fff; border: 1px solid #ccc; box-shadow: 0 6px 16px rgba(0,0,0,0.12); 
    z-index: 1000; min-width: 200px; border-radius: 6px; padding: 6px 0;
    overflow: hidden;
}
.nav-tree:hover .nav-dropdown { display: block; }
.nav-dropdown .dropdown-group { padding: 6px 12px 2px 12px; font-size: 9px; text-transform: uppercase; color: #888; font-weight: 700; letter-spacing: 0.05em; border-top: 1px solid #eee; margin-top: 4px; }
.nav-dropdown .dropdown-group:first-child { border-top: none; margin-top: 0; padding-top: 4px; }
.nav-dropdown a { 
    display: flex; justify-content: space-between; align-items: center;
    padding: 8px 14px; color: #444; text-decoration: none; 
    font-size: 12px; transition: all 0.1s;
}
.nav-dropdown a:hover { background: #f0f7ff; color: #0056b3; }
.nav-dropdown a.active { background: #f8f9fa; color: #000; font-weight: 700; cursor: default; }
.nav-dropdown a.active::after { content: "\2713"; font-size: 10px; color: #28a745; }
.nav-dropdown a.stig-link { color: #5f2e43; }
.nav-dropdown a.stig-link:hover { background: #fff0f5; color: #800040; }
.summary-line { font-size: 12px; margin-bottom: 12px; color: #333; }
.summary-line span { margin-right: 16px; }
.kv td:first-child { width: 38%; color: #444; font-size: 12px; }
.kv td:last-child  { font-weight: 500; }
.no-data { color: #888; padding: 8px; border: 1px solid #ddd; font-size: 12px; }
.health-ok    { color: #166534; font-weight: bold; }
.health-warn  { color: #d97706; font-weight: bold; }
.health-crit  { color: #dc2626; font-weight: bold; }
.health-unk   { color: #555; font-weight: bold; }
.empty-state  { text-align: center; padding: 40px; color: #7f8c8d; }
.text-right   { text-align: right; }
.mt-14        { margin-top: 14px; }
.severity-cell { white-space: nowrap; padding-left: 20px; }
 
/* --- Widgets --- */
.widget { margin-bottom: 14px; }
.widget-titlebar { background: #1e2a3a; color: #fff; border: 1px solid #0f1820; padding: 4px 8px; display: flex; justify-content: space-between; align-items: center; }
.titlebar-link { color: #9db4cc; text-decoration: none; font-weight: normal; }
.titlebar-link:hover { color: #fff; text-decoration: underline; }
.widget-title { font-size: 13px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.04em; flex: 1; }
.js .widget-titlebar:has(.widget-toggle) { cursor: pointer; user-select: none; }
.js .widget-titlebar:has(.widget-toggle):hover { background: #2a3a4a; }
.js .widget-grid .widget-titlebar:has(.widget-toggle):hover { background: #eee; }
.widget-toggle { display: none; }
.js .widget-toggle { display: inline-flex; align-items: center; justify-content: center; background: none; border: 1px solid rgba(255,255,255,0.35); color: #fff; cursor: pointer; border-radius: 2px; width: 18px; height: 18px; padding: 0; font-size: 10px; flex-shrink: 0; line-height: 1; }
.js .widget-toggle:hover { background: rgba(255,255,255,0.15); }
.js .widget-toggle::before { content: '\2212'; }
.js .widget-toggle[aria-expanded="false"]::before { content: '+'; }
.widget-body { }
.widget-body table { margin-bottom: 0; }
 
/* Subwidgets (Nested Cards) */
.widget-subgroup { padding: 7px; background: #fafafa; display: flex; flex-direction: column; gap: 14px; border: 1px #eee solid; }
.widget-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 14px; }
.widget-grid .widget { margin-bottom: 0; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
.widget-grid .widget-titlebar { background: #fff; color: #333; border-color: #ddd; }
.widget-grid .widget-body table { border: 0; }
 
/* Alert widget variant */
.widget-alert { border: 1px solid #5f2e43; margin-bottom: 14px; }
.widget-alert .widget-titlebar { background: #5f2e43; border-bottom: 1px solid #5f2e43; border-left: none; border-right: none; border-top: none; }
 
/* --- Group rows (site report alert host groups) --- */
.group-hdr td { padding: 5px 8px; border-bottom: 1px solid #ccc; }
.group-platform { margin-left: 8px; font-size: 11px; color: #555; font-weight: 600; text-transform: uppercase; }
.platform-name { text-transform: capitalize; }
 
.js tr.group-hdr { cursor: pointer; user-select: none; }
.group-toggle { display: none; }
.js .group-toggle { display: inline-flex; align-items: center; justify-content: center; background: #fff; border: 1px solid #ccc; color: #333; cursor: pointer; border-radius: 2px; width: 16px; height: 16px; padding: 0; font-size: 10px; margin-right: 6px; line-height: 1; vertical-align: middle; }
.group-toggle::before { content: '\2212'; }
.group-hdr-collapsed .group-toggle::before { content: '+'; }

@media print {
  .widget-body { display: block !important; }
  .widget-toggle { display: none !important; }
  .header-actions { display: none; }
  tr.group-row { display: table-row !important; }
  .toc { display: none; }
}




/* Details Panels */
.details-box { background-color: #fafafa; border: 1px solid #eee; padding: 15px; margin-top: 10px; border-radius: 4px; font-size: 0.9rem; display: none; }
.details-box pre { white-space: pre-wrap; background: #fff; border: 1px solid #ddd; padding: 10px; font-family: monospace; color: #444; overflow-x: auto; }
.toggle-btn { background: none; border: none; color: #3498db; cursor: pointer; text-decoration: none; font-size: 0.85rem; margin-top: 5px; padding: 0; text-align: left; }
.toggle-btn:hover { text-decoration: underline; }
.col-id { width: 130px; font-weight: bold; font-family: monospace; }
.col-status { width: 120px; }
.col-sev { width: 80px; }
