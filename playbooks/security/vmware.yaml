---
# playbooks/plays/stig_audit_vmware.yaml
# Perform STIG compliance audit for VMware/vSphere components.

- name: VMware Security Audit
  hosts: vcenters
  gather_facts: false

  pre_tasks:
    - name: Setup Role Context
      ansible.builtin.import_tasks: ../common/setup_host_ctx.yaml

  tasks:
    - name: Audit vCenter Guest STIGs
      ansible.builtin.include_role:
        name: internal.vmware.stig
        tasks_from: vm.yaml
      vars:
        ansible_connection: local
      tags: ["vsphere", "stig"]
