---
# playbooks/security/vmware.yaml
#
# STIG compliance audit for VMware vSphere VM guests.
# Runs on-demand, not part of the daily schedule.
#
# Usage:
#   ansible-playbook playbooks/security/vmware.yaml
#   ansible-playbook playbooks/security/vmware.yaml -e "stig_vm_filter=vm-name"

- name: VMware STIG Audit
  hosts: vcenters
  gather_facts: false
  tasks:
    - name: Audit vSphere VM STIGs
      ansible.builtin.include_role:
        name: internal.vmware.stig
      vars:
        stig_target_type: vm
      tags: [vsphere, stig]
