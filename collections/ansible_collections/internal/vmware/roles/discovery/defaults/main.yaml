---
# collections/ansible_collections/internal/vmware/roles/discovery/defaults/main.yaml

# Configuration Thresholds (Can be overridden in group_vars)
vmware_discovery_timeout: 30
vmware_skip_discovery: false
vmware_validate_ctx_schema: true

# Primary Data Model: vmware_ctx
# This object is exported as the host's state for Phase 3.
vmware_ctx:
  audit_type: "vcenter_health"
  checks_failed: false

  # 1. Identity & Metadata
  system:
    name: "{{ inventory_hostname }}"
    hostname: ""
    status: "PENDING"
    updated_at: ""

  # 2. Infrastructure Health (VCSA VAMI data)
  health:
    appliance:
      status: "NOT_RUN"
      error: ""
      collected_at: ""
      info: {version: "unknown", build: "unknown", uptime_days: 0}
      health:
        overall: "gray"
        cpu: "gray"
        memory: "gray"
        database: "gray"
        storage: "gray"
        swap: "gray"
      config:
        ssh_enabled: false
        shell_enabled: false
        ntp_servers: []
        ntp_mode: "unknown"
        timezone: "UTC"
      backup: {enabled: false, configured: false, status: "UNKNOWN"}
    alarms:
      status: "NOT_RUN"
      error: ""
      collected_at: ""
      list: []
      metrics: {total: 0, critical_count: 0, warning_count: 0}
      critical_items: []

  # 3. Environment Inventory (Compute, Storage, Workload)
  inventory:
    datacenters:
      status: "NOT_RUN"
      error: ""
      collected_at: ""
      list: []
      raw: []
      by_name: {}
      summary:
        total_count: 0
        primary_dc: ""
    clusters:
      status: "NOT_RUN"
      error: ""
      collected_at: ""
      list: []
      by_name: {}
    hosts:
      status: "NOT_RUN"
      error: ""
      collected_at: ""
      list: []
      count: 0
    datastores:
      status: "NOT_RUN"
      error: ""
      collected_at: ""
      list: []
      summary:
        total_count: 0
        inaccessible_count: 0
        low_space_count: 0
        maintenance_count: 0
    vms:
      status: "NOT_RUN"
      error: ""
      collected_at: ""
      list: []
      summary:
        {total_vms: 0, overdue_backups: 0, unprotected: 0, missing_owners: 0}
      metrics: {powered_off_count: 0, powered_off_pct: 0}

    # Snapshots are populated during discovery phase
    snapshots:
      status: "NOT_RUN"
      error: ""
      collected_at: ""
      all: []
      aged: []
      summary:
        total_count: 0
        aged_count: 0
        total_size_gb: 0.0
        large_snapshots: []
        oldest_days: 0
        status: "NOT_RUN"
        error: ""

  # 4. Phase 2 Result Data
  alerts: []
