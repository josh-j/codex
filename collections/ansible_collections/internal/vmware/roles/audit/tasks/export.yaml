---
# internal.vmware.audit : tasks/export.yaml

- name: Export VMware vCenter audit state for aggregation
  ansible.builtin.include_role:
    name: internal.core.state
    tasks_from: export
  vars:
    ncs_export_path: "{{ _vmware_audit_export_path }}"
    ncs_export_data: "{{ _vmware_audit_export_data }}"
    # Optional: persist alerts into vmware_ctx for template consumers.
    # vmware_ctx is still included under export payload data.
    # vmware_ctx: >-
    #   {{
    #     vmware_ctx | combine({
    #       'alerts': (vmware_alerts | default([]) | list)
    #     }, recursive=true)
    #   }}
