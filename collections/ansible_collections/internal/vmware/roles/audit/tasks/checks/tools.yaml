---
# internal.vmware.audit : tasks/checks/tools.yaml

- name: Audit | Evaluate VMware Tools Compliance
  ansible.builtin.set_fact:
    vmware_alerts: >-
      {{
        (vmware_alerts | default([]) | list)
        | internal.core.append_alerts(
          vmware_ctx
          | internal.vmware.audit_tools_alerts(
            vmware_tools_items_max | default(50) | int
          )
        )
      }}
  changed_when: false
  when: vmware_ctx is defined and vmware_ctx.get('inventory', {}).get('vms') is defined
