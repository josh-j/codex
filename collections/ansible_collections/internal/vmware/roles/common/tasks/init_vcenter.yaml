---
# collections/ansible_collections/internal/vmware/roles/common/tasks/init_vcenter.yaml
#
# Sets _vcenter_hostname from the best available source.
# Called by any vmware role that needs to make API calls.
# Safe to call multiple times - set_fact is idempotent.

- name: Set vCenter target hostname
  ansible.builtin.set_fact:
    _vcenter_hostname: >-
      {{
        (vmware_hostname | default(ansible_host) | default(inventory_hostname))
        | regex_replace('^https?://', '')
        | regex_replace('/.*$', '')
      }}
  when: _vcenter_hostname is not defined
