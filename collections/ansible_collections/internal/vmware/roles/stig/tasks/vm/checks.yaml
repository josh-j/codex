---
# internal.vmware.stig : vm/checks.yaml

- name: "VM STIG | Evaluate compliance per VM"
  tags: [stig, audit]
  ansible.builtin.include_role:
    name: internal.core.stig
    tasks_from: audit_orchestrator
  vars:
    raw_discovery_data: >-
      {{
        (vsphere_ctx.stig_facts | default([]))
        | rejectattr('name', 'search', 'vCLS')
        | list
      }}
    audit_logic_template: "{{ role_path }}/templates/vm_logic.j2"
    stig_filter: "{{ stig_vm_filter | default('') }}"
    stig_exclusions: "{{ exclusion_list | default([]) }}"
