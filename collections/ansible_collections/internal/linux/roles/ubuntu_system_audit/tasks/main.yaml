---
# collections/ansible_collections/internal/linux/roles/ubuntu_system_audit/tasks/main.yaml

- name: Validate discovery data exists
  ansible.builtin.assert:
    that:
      - ubuntu_ctx is defined
      - ubuntu_ctx.system is defined
      - ubuntu_ctx.updates is defined
      - ubuntu_ctx.security is defined
    fail_msg: >-
      ubuntu_ctx is not defined or incomplete.
      Run the ubuntu_system_discover role before this one.

- name: Run system checks
  ansible.builtin.import_tasks: check.yaml
  when: not (ubuntu_skip_checks | default(false) | bool)

- name: Export results
  ansible.builtin.import_tasks: export.yaml
  when: not (ubuntu_skip_export | default(false) | bool)
