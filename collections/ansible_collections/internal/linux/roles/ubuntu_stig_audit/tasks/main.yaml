---
# internal.linux.ubuntu_stig_audit : tasks/main.yaml

- name: Ubuntu STIG Audit
  block:
    - name: "Ubuntu STIG | Run audit"
      tags: [checks, stig, security]
      ansible.builtin.import_tasks: check.yaml

  rescue:
    - name: "Ubuntu STIG | Log failure"
      ansible.builtin.debug:
        msg: "Ubuntu STIG audit failed on {{ inventory_hostname }} â€” export will indicate failure."
      register: _ubuntu_task_failure

  always:
    - name: "Ubuntu STIG | Export results"
      tags: [always, export]
      ansible.builtin.import_tasks: export.yaml
