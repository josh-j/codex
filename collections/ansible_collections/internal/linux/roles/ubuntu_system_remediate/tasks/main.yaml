- name: Ubuntu System Remediation Wrapper
  block:
    - name: Maintenance - Patching, Hardening & Reboot
      ansible.builtin.include_tasks: maintain.yaml
      tags: ['maintenance']
      when: ubuntu.config.enable_maintenance | default(false) | bool

  # RESCUE: Only runs if something in the 'block' above FAILED
  rescue:
    - name: Log Ubuntu Failure
      ansible.builtin.debug:
        msg: "Ubuntu tasks failed on {{ inventory_hostname }}. Report will indicate failure."
      # This registers a variable we can check in the summary report if needed
      register: _ubuntu_task_failure
