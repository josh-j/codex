---
# playbooks/ubuntu_audit.yml
# Detailed system discovery and health auditing for Ubuntu Linux hosts.
# This playbook executes the 'discover' action within the internal.linux.ubuntu
# collection to collect hardware specs, OS versioning, and service states.
# It identifies system vulnerabilities, missing security updates, and
# configuration drift against established baseline standards.
# The resulting telemetry is persisted for the centralized reporting engine.

- name: "Phase 2: Ubuntu System Audit"
  hosts: "{{ ubuntu_target_hosts | default('ubuntu_servers') }}"
  gather_facts: false
  tags: ["ubuntu", "audit", "system"]
  roles:
    - role: internal.linux.ubuntu
      vars:
        ubuntu_action: discover
        # Default thresholds are defined in roles/ubuntu/defaults/main.yaml
